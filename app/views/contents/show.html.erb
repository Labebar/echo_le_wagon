<div class="container" data-controller="toggle-section">


  <%# section image et video %>
  <div id="video-wrapper">
    <%= image_tag @content.thumbnail, id: "video-thumbnail", class: "img-fluid", onclick: "showVideo()" if @content.thumbnail.present? %>
  </div>
  <h1><%= @content.name %></h1>
  <p><em>Durée : <%= format_duration(@content.duration) %></em></p>
    <script>
      const thumbnailHtml = `<img src="<%= @content.thumbnail %>" id="video-thumbnail" class="img-fluid" onclick="showVideo()">`;
      const videoHtml = `
        <iframe class="img-fluid" src="<%= youtube_embed_url(@content.url) %>" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        <br>
        <button onclick="showThumbnail()" style="margin-top: 10px;" class="btn btn-secondary">Close</button>`;
      function showVideo() {
        document.getElementById("video-wrapper").innerHTML = videoHtml;
      }
      function showThumbnail() {
        document.getElementById("video-wrapper").innerHTML = thumbnailHtml;
      }
    </script>

  <p>Language <strong><%= @content.language %></strong></p>
  <p>This content is <%= @content.duration %> min long</p>

  <%= link_to 'EDIT', edit_content_path(@content), class: 'custom-button' %>

  <!-- Boutons -->
  <%= button_tag 'SUMMARY', type: 'button', class: 'custom-button', data: { action: "toggle-section#toggle", target_id: "summary-section" } %>
  <%= button_tag 'QUIZZ', type: 'button', class: 'custom-button', data: { action: "toggle-section#toggle quiz-loader#startQuiz", target_id: "quizz-section" } %>  <%= button_tag 'ASK IA', type: 'button', class: 'custom-button', data: { action: "toggle-section#toggle", target_id: "#" } %>
  <%= button_tag 'NOTES', type: 'button', class: 'custom-button', data: { action: "toggle-section#toggle", target_id: "#" } %>

  <!-- Résumé -->
  <div id="summary-section" class="summary-text" data-toggle-section-target="section" style="display: none;">
    <h1> <%= @content.name %></h1>
    <%= raw @content.summary[7..-4] if @content.summary %>
  </div>

  <!-- QUIZZ Dynamique -->
 <div id="quizz-section"
     data-controller="quiz-loader"
     data-quiz-loader-url-value="<%= generate_question_content_path(@content) %>"
     data-toggle-section-target="section"
     style="display: block;">
  <h2>Quiz questions</h2>
  <div id="quiz-container"></div>

  <div class="mt-3">
    <button data-action="quiz-loader#generateQuestion" class="btn btn-primary">Next Question</button>
  </div>
</div>
</div>
